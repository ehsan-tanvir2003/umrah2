
<div class="max-w-6xl mx-auto space-y-6">
  <!-- Header & Filters -->
  <div class="bg-white p-6 rounded-lg shadow-md no-print">
    <div class="flex justify-between items-center">
        <div>
            <h2 class="text-2xl font-bold text-gray-800">Profit & Loss Statement</h2>
            <p class="text-sm text-gray-500 mt-1">Generate a report to see income, expenses, and net profit.</p>
        </div>
        <button (click)="printReport()" class="px-4 py-2 bg-teal-600 text-white rounded-md hover:bg-teal-700 flex items-center">
            <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6 13.829m0 0c0 1.131.91 2.042 2.029 2.042h.02a2.05 2.05 0 0 0 2.042-2.042M6 13.829c0-1.131.91-2.042 2.029-2.042h.02a2.05 2.05 0 0 0 2.042 2.042m0 0H8.05M6 13.829c-1.131 0-2.042-.91-2.042-2.029V6.75a2.029 2.029 0 0 1 2.042-2.029h.022a2.029 2.029 0 0 1 2.029 2.029v1.125m-2.072.062c.618.026 1.244.043 1.875.056m0 0c.341.006.678.012 1.018.016m0 0c.618-.026 1.244-.043 1.875-.056m0 0c.341-.006.678-.012 1.018-.016m0 0c1.131 0 2.042.91 2.042 2.029v6.098c0 1.131-.911 2.042-2.042 2.042a.02.02 0 0 1-.022 0Z" /></svg>
            Print
        </button>
    </div>
    <form [formGroup]="filterForm" (ngSubmit)="generateReport()" class="mt-4 flex items-end space-x-4">
        <div>
            <label class="block text-sm font-medium text-gray-700">Start Date</label>
            <input type="date" formControlName="startDate" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm">
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700">End Date</label>
            <input type="date" formControlName="endDate" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm">
        </div>
        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Generate Report</button>
    </form>
  </div>

  <!-- Report Display -->
  @if(reportData(); as data) {
    <div class="bg-white p-6 rounded-lg shadow-md printable-area">
      <h3 class="text-xl font-bold text-center text-gray-800">Profit & Loss Statement</h3>
      <p class="text-center text-gray-500">For the period: {{ filterForm.value.startDate }} to {{ filterForm.value.endDate }}</p>

      <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
        <div class="p-4 bg-green-50 rounded-lg">
            <h4 class="text-sm font-medium text-gray-500">TOTAL INCOME</h4>
            <p class="text-2xl font-bold text-green-600 mt-1">৳{{ data.totalIncome.toLocaleString('en-BD') }}</p>
        </div>
        <div class="p-4 bg-red-50 rounded-lg">
            <h4 class="text-sm font-medium text-gray-500">TOTAL EXPENSES</h4>
            <p class="text-2xl font-bold text-red-600 mt-1">৳{{ data.totalExpenses.toLocaleString('en-BD') }}</p>
        </div>
        <div class="p-4 rounded-lg" [class]="data.netProfit >= 0 ? 'bg-blue-50' : 'bg-orange-50'">
            <h4 class="text-sm font-medium text-gray-500">NET PROFIT / LOSS</h4>
            <p class="text-2xl font-bold mt-1" [class]="data.netProfit >= 0 ? 'text-blue-600' : 'text-orange-600'">
                ৳{{ data.netProfit.toLocaleString('en-BD') }}
            </p>
        </div>
      </div>

      <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-8">
        <!-- Income Table -->
        <div>
            <h4 class="text-lg font-semibold text-gray-700 mb-2">Income</h4>
            <table class="min-w-full divide-y divide-gray-200 border">
                <thead class="bg-gray-50"><tr><th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Date</th><th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Description</th><th class="px-4 py-2 text-right text-xs font-medium text-gray-500">Amount</th></tr></thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    @for(item of data.income; track item.id){<tr><td class="px-4 py-2 text-sm">{{item.date}}</td><td class="px-4 py-2 text-sm">{{item.description}}</td><td class="px-4 py-2 text-right text-sm font-semibold">৳{{item.amount.toLocaleString('en-BD')}}</td></tr>}
                    <tr class="bg-gray-50 font-bold"><td colspan="2" class="px-4 py-2 text-right">Total Income</td><td class="px-4 py-2 text-right">৳{{data.totalIncome.toLocaleString('en-BD')}}</td></tr>
                </tbody>
            </table>
        </div>
        <!-- Expenses Table -->
        <div>
            <h4 class="text-lg font-semibold text-gray-700 mb-2">Expenses</h4>
            <table class="min-w-full divide-y divide-gray-200 border">
                <thead class="bg-gray-50"><tr><th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Date</th><th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Description</th><th class="px-4 py-2 text-right text-xs font-medium text-gray-500">Amount</th></tr></thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    @for(item of data.expenses; track item.id){<tr><td class="px-4 py-2 text-sm">{{item.date}}</td><td class="px-4 py-2 text-sm">{{item.description}}</td><td class="px-4 py-2 text-right text-sm font-semibold">৳{{item.amount.toLocaleString('en-BD')}}</td></tr>}
                    <tr class="bg-gray-50 font-bold"><td colspan="2" class="px-4 py-2 text-right">Total Expenses</td><td class="px-4 py-2 text-right">৳{{data.totalExpenses.toLocaleString('en-BD')}}</td></tr>
                </tbody>
            </table>
        </div>
      </div>
    </div>
  } @else {
    <div class="text-center py-12 text-gray-500">
      <p>Please select a date range and click "Generate Report" to see the data.</p>
    </div>
  }
</div>
<style>
@media print {
    body { background-color: #fff; }
    .no-print { display: none; }
    .printable-area { box-shadow: none; border: 1px solid #e5e7eb; }
    app-root > div { display: none; }
    app-profit-loss-report { display: block !important; }
}
</style>
